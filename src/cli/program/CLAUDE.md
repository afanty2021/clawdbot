# CLI ç¨‹åºæ¨¡å— (src/cli/program/)

[æ ¹ç›®å½•](../../CLAUDE.md) > [src](../CLAUDE.md) > [cli](./CLAUDE.md) > **program**

## æ¨¡å—èŒè´£

æä¾› OpenClaw CLI ç¨‹åºçš„æ„å»ºå’Œé…ç½®ç³»ç»Ÿã€‚è¯¥æ¨¡å—å®šä¹‰äº† CLI çš„å…¥å£ç»“æ„ã€å‘½ä»¤æ³¨å†Œã€å…¨å±€é€‰é¡¹å’Œä¾èµ–æ³¨å…¥ï¼Œæ˜¯æ•´ä¸ªå‘½ä»¤è¡Œå·¥å…·çš„åŸºç¡€æ¶æ„ã€‚

## ç›®å½•ç»“æ„

```
src/cli/program/
â”œâ”€â”€ program.ts          # ç¨‹åºå…¥å£
â”œâ”€â”€ deps.ts             # ä¾èµ–æ³¨å…¥
â”œâ”€â”€ force.ts            # å¼ºåˆ¶æ‰§è¡Œ
â”œâ”€â”€ force.test.ts       # å¼ºåˆ¶æµ‹è¯•
â”œâ”€â”€ nodes-basic.test.ts  # èŠ‚ç‚¹åŸºç¡€æµ‹è¯•
â”œâ”€â”€ nodes-media.test.ts  # åª’ä½“èŠ‚ç‚¹æµ‹è¯•
â”œâ”€â”€ smoke.test.ts       # å†’çƒŸæµ‹è¯•
â””â”€â”€ shared/             # å…±äº«æ¨¡å—
    â”œâ”€â”€ utils.ts        # å·¥å…·å‡½æ•°
    â”œâ”€â”€ format.ts       # æ ¼å¼åŒ–
    â””â”€â”€ constants.ts    # å¸¸é‡å®šä¹‰
```

## å…¥å£ä¸å¯åŠ¨

### ä¸»å…¥å£
- **`src/cli/program/program.ts`** - CLI ç¨‹åºæ„å»ºå™¨

### å¯åŠ¨æµç¨‹
```typescript
import { CliProgram } from "./cli/program/program.ts";

const program = new CliProgram({
  name: "openclaw",
  version: "1.0.0",
});

await program.run();
```

## å¯¹å¤–æ¥å£

### CliProgram æ¥å£
```typescript
interface CliProgram {
  name: string;
  version: string;
  commands: Command[];
  globalOptions: GlobalOption[];

  addCommand(command: Command): void;
  addGlobalOption(option: GlobalOption): void;
  run(args?: string[]): Promise<void>;
  parse(args: string[]): ParsedResult;
}
```

### Command æ¥å£
```typescript
interface Command {
  name: string;
  description: string;
  aliases?: string[];
  arguments?: CommandArgument[];
  options?: CommandOption[];
  handler: CommandHandler;
  subcommands?: Command[];
}
```

### CommandHandler æ¥å£
```typescript
interface CommandHandler {
  (args: ParsedArgs, options: ParsedOptions, context: CommandContext): Promise<void>;
}
```

## å­æ¨¡å—è¯¦è§£

### 1. ç¨‹åºæ„å»ºå™¨ (`program.ts`)

**èŒè´£**ï¼šæ„å»ºå’Œé…ç½® CLI ç¨‹åº

**åŠŸèƒ½**ï¼š
- å‘½ä»¤æ³¨å†Œ
- é€‰é¡¹è§£æ
- å¸®åŠ©ç”Ÿæˆ
- è‡ªåŠ¨è¡¥å…¨

### 2. ä¾èµ–æ³¨å…¥ (`deps.ts`)

**èŒè´£**ï¼šæä¾› CLI ä¾èµ–æ³¨å…¥å®¹å™¨

**æ³¨å…¥é¡¹**ï¼š
- ConfigLoader - é…ç½®åŠ è½½å™¨
- GatewayClient - ç½‘å…³å®¢æˆ·ç«¯
- Logger - æ—¥å¿—å™¨
- HttpClient - HTTP å®¢æˆ·ç«¯

### 3. å¼ºåˆ¶æ‰§è¡Œ (`force.ts`)

**èŒè´£**ï¼šå¤„ç†éœ€è¦å¼ºåˆ¶æ‰§è¡Œçš„å‘½ä»¤

**ä½¿ç”¨åœºæ™¯**ï¼š
- å¼ºåˆ¶è¦†ç›–é…ç½®
- å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹
- å¼ºåˆ¶åˆ é™¤èµ„æº

### 4. æµ‹è¯•æ¨¡å—

**èŒè´£**ï¼šCLI ç¨‹åºçš„æµ‹è¯•å¥—ä»¶

**æµ‹è¯•ç±»å‹**ï¼š
- `smoke.test.ts` - å†’çƒŸæµ‹è¯•
- `nodes-basic.test.ts` - åŸºç¡€èŠ‚ç‚¹æµ‹è¯•
- `nodes-media.test.ts` - åª’ä½“èŠ‚ç‚¹æµ‹è¯•

## å…³é”®ä¾èµ–ä¸é…ç½®

### å…¨å±€é€‰é¡¹
```bash
--verbose, -v     # è¯¦ç»†è¾“å‡º
--config, -c      # é…ç½®æ–‡ä»¶è·¯å¾„
--profile         # é…ç½® profile
--dry-run         # æ¨¡æ‹Ÿæ‰§è¡Œ
--force, -f       # å¼ºåˆ¶æ‰§è¡Œ
```

### ç¯å¢ƒå˜é‡
```bash
OPENCLAW_CLI_NAME     # CLI åç§°
OPENCLAW_CLI_VERSION  # CLI ç‰ˆæœ¬
OPENCLAW_DEBUG        # è°ƒè¯•æ¨¡å¼
```

## æµ‹è¯•ä¸è´¨é‡

### æµ‹è¯•æ–‡ä»¶
- `src/cli/program/**/*.test.ts`

### æµ‹è¯•å‘½ä»¤
```bash
pnpm test src/cli/program
pnpm test src/cli/program --smoke
```

## å¸¸è§é—®é¢˜ (FAQ)

### Q: å¦‚ä½•æ·»åŠ æ–°å‘½ä»¤ï¼Ÿ
A: åœ¨ `src/commands/` åˆ›å»ºå‘½ä»¤æ–‡ä»¶ï¼Œåœ¨ç¨‹åºä¸­æ³¨å†Œã€‚

### Q: å¦‚ä½•è‡ªå®šä¹‰å…¨å±€é€‰é¡¹ï¼Ÿ
A: ä½¿ç”¨ `addGlobalOption()` æ–¹æ³•æ·»åŠ ã€‚

### Q: è°ƒè¯•æ¨¡å¼å¦‚ä½•å¯ç”¨ï¼Ÿ
A: è®¾ç½® `OPENCLAW_DEBUG=1` æˆ–ä½¿ç”¨ `-v` é€‰é¡¹ã€‚

## ç›¸å…³æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒæ–‡ä»¶
- `src/cli/program/program.ts` - ç¨‹åºå…¥å£
- `src/cli/program/deps.ts` - ä¾èµ–æ³¨å…¥

### CLI å‘½ä»¤
- `src/cli/**/*.ts` - å„å‘½ä»¤å®ç°

## å˜æ›´è®°å½•

### 2026-02-10 - åˆ›å»º CLI ç¨‹åºæ¨¡å—æ–‡æ¡£
- âœ… åˆ›å»º `src/cli/program/CLAUDE.md` æ–‡æ¡£
- ğŸ“‹ è®°å½•ç¨‹åºæ„å»ºå’Œä¾èµ–æ³¨å…¥
- ğŸ”— å»ºç«‹ CLI æ¶æ„å¯¼èˆª


<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Feb 10, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #2212 | 10:30 AM | ğŸŸ£ | Documentation coverage campaign achieved 100% core module coverage | ~546 |
| #2207 | 10:25 AM | ğŸŸ£ | Documentation coverage significantly improved - 10 new CLAUDE.md files created | ~538 |
</claude-mem-context>