# CLI Runner 模块 (cli-runner/)

> [返回父模块目录](../) > [返回agents模块目录](../) > **cli-runner**

## 模块职责

CLI Runner 模块提供守护进程管理和 CLI 会话处理功能，用于在后台运行 OpenClaw 服务并管理 CLI 命令的执行上下文。

## 目录结构

```
cli-runner/
├── daemon.ts          # 守护进程管理
└── register.ts        # CLI 注册器
```

## 关键文件详解

### daemon.ts

**职责**: 守护进程管理核心功能

**主要功能**:
- 守护进程启动和停止
- 进程状态监控
- 信号处理（SIGTERM、SIGINT）
- 日志记录

**关键函数**:
```typescript
interface DaemonConfig {
  pidFile: string;           // PID 文件路径
  logFile: string;           // 日志文件路径
  workingDir: string;        // 工作目录
}

function startDaemon(config: DaemonConfig): Promise<void>;
function stopDaemon(pidFile: string): Promise<void>;
function getDaemonStatus(pidFile: string): DaemonStatus;
```

### register.ts

**职责**: CLI 注册和集成

**主要功能**:
- CLI 命令注册
- 守护进程上下文检测
- 命令路由

## 使用场景

### 守护进程模式
```bash
# 启动为守护进程
openclaw daemon start --port 18789 --verbose

# 停止守护进程
openclaw daemon stop

# 查看状态
openclaw daemon status
```

### CLI 集成
```typescript
import { registerCliRunner } from './cli-runner/register.js';

// 注册 CLI Runner
registerCliRunner(program);
```

## 与其他模块的交互

- **`src/cli/program.ts`**: CLI 程序入口，集成守护进程命令
- **`src/process/`**: 进程管理和命令队列
- **`src/daemon/`**: 守护进程底层实现

## 测试

```bash
# 运行 CLI Runner 测试
pnpm test src/agents/cli-runner/*.test.ts
```

## 常见问题 (FAQ)

### Q: 守护进程无法启动？
A: 检查端口是否被占用，确认日志文件路径有写权限。

### Q: 如何查看守护进程日志？
A: 使用 `openclaw logs` 命令或查看配置的日志文件路径。

## 相关文件

- `src/cli/daemon-cli/` - 守护进程 CLI
- `src/process/` - 进程管理
- `src/daemon/` - 守护进程底层实现


<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Feb 11, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #2590 | 12:08 AM | ✅ | Created comprehensive Chinese documentation for 6 OpenClaw modules | ~652 |
| #2587 | 12:07 AM | ✅ | Created comprehensive Chinese documentation for 6 OpenClaw modules | ~576 |
</claude-mem-context>