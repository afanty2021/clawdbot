# Device Pair æ‰©å±•

[è¿”å›ç›®å½•](../CLAUDE.md) > **extensions/device-pair**

## æ¨¡å—èŒè´£

è®¾å¤‡é…å¯¹åŠŸèƒ½æ’ä»¶ï¼Œæä¾›ç§»åŠ¨èŠ‚ç‚¹ï¼ˆiOS/Androidï¼‰ä¸ Gateway ä¹‹é—´çš„å®‰å…¨é…å¯¹æœºåˆ¶ã€‚

## åŠŸèƒ½æ¦‚è¿°

### é…å¯¹åŠŸèƒ½
- **ç”Ÿæˆé…å¯¹ä»£ç **ï¼šBase64 ç¼–ç çš„é…å¯¹è®¾ç½®ä»£ç 
- **å®¡æ‰¹è¯·æ±‚**ï¼šå®¡æ‰¹å¾…å¤„ç†çš„è®¾å¤‡é…å¯¹è¯·æ±‚
- **çŠ¶æ€æŸ¥è¯¢**ï¼šæŸ¥çœ‹é…å¯¹çŠ¶æ€å’Œå¾…å¤„ç†è¯·æ±‚
- **è‡ªåŠ¨è¿‡æœŸ**ï¼šæ”¯æŒå¯é€‰çš„è‡ªåŠ¨è¿‡æœŸæ—¶é—´

### æ”¯æŒçš„å‘½ä»¤
- `/phone` - æ‰‹æœºæ§åˆ¶å‘½ä»¤ï¼ˆæ­¦è£…/è§£é™¤æ­¦è£…é«˜é£é™©åŠŸèƒ½ï¼‰
- `/pair` - è®¾å¤‡é…å¯¹å‘½ä»¤

### ç»‘å®šæ¨¡å¼
- **loopback**ï¼ˆé»˜è®¤ï¼‰ï¼šä»…æœ¬åœ°è®¿é—®
- **lan**ï¼šå±€åŸŸç½‘è®¿é—®ï¼ˆç§æœ‰ IPï¼‰
- **tailnet**ï¼šTailscale ç½‘ç»œè®¿é—®
- **custom**ï¼šè‡ªå®šä¹‰ç»‘å®šä¸»æœº

## å¯¹å¤–æ¥å£

### é…å¯¹å‘½ä»¤
```bash
/pair                    # ç”Ÿæˆæ–°çš„é…å¯¹ä»£ç 
/pair status              # æŸ¥çœ‹å¾…å¤„ç†è¯·æ±‚
/pair approve <requestId>  # å®¡æ‰¹æŒ‡å®šè¯·æ±‚
/pair approve latest       # å®¡æ‰¹æœ€æ–°è¯·æ±‚
```

### é…å¯¹è½½è·
```typescript
{
  url: string,           // WebSocket URL
  token?: string,        // è®¤è¯ä»¤ç‰Œ
  password?: string,     // è®¤è¯å¯†ç 
}
```

### è®¾ç½®ä»£ç æ ¼å¼
```
Base64(JSON.stringify({
  url: "wss://gateway:port",
  token: "...",
  password: "...",
}))
```

## å…³é”®ä¾èµ–

### OpenClaw Plugin SDK
- `openclaw/plugin-sdk` - æ’ä»¶å¼€å‘å·¥å…·åŒ…
- `approveDevicePairing` - å®¡æ‰¹é…å¯¹è¯·æ±‚
- `listDevicePairing` - åˆ—å‡ºå¾…å¤„ç†è¯·æ±‚

### ç½‘ç»œæ¥å£
- **Tailscale**ï¼šMagicDNS åç§°å’Œ Tailscale IP
- **ç§æœ‰ IP**ï¼š10.x.x.xã€172.16-31.x.xã€192.168.x.x
- **CNAT IP**ï¼š100.64-127.x.x

### è®¤è¯æ¨¡å¼
- **token**ï¼šä»¤ç‰Œè®¤è¯
- **password**ï¼šå¯†ç è®¤è¯
- **è‡ªåŠ¨æ£€æµ‹**ï¼šæ ¹æ®é…ç½®è‡ªåŠ¨é€‰æ‹©

## ä½¿ç”¨è¯´æ˜

### é…å¯¹æµç¨‹
1. **ç”Ÿæˆé…å¯¹ä»£ç **
   ```bash
   /pair
   ```

2. **åœ¨ iOS åº”ç”¨ä¸­é…å¯¹**
   - æ‰“å¼€ iOS åº”ç”¨ â†’ è®¾ç½® â†’ Gateway
   - ç²˜è´´é…å¯¹ä»£ç å¹¶ç‚¹å‡»è¿æ¥

3. **å®¡æ‰¹é…å¯¹è¯·æ±‚**
   ```bash
   # æŸ¥çœ‹å¾…å¤„ç†è¯·æ±‚
   /pair status

   # å®¡æ‰¹æŒ‡å®šè¯·æ±‚
   /pair approve <requestId>

   # å®¡æ‰¹æœ€æ–°è¯·æ±‚
   /pair approve latest
   ```

### Gateway URL è§£æ
1. **Tailscale Serve**ï¼šä¼˜å…ˆä½¿ç”¨ Tailscale MagicDNS
2. **è¿œç¨‹ URL**ï¼šä½¿ç”¨ `gateway.remote.url`
3. **è‡ªå®šä¹‰ç»‘å®š**ï¼šä½¿ç”¨ `gateway.customBindHost`
4. **Tailnet IP**ï¼šè‡ªåŠ¨é€‰æ‹© CNAT IP
5. **LAN IP**ï¼šè‡ªåŠ¨é€‰æ‹©ç§æœ‰ IP

## é…ç½®é€‰é¡¹

### æ’ä»¶é…ç½®
```typescript
{
  publicUrl?: string,  // è¦†ç›–è‡ªåŠ¨æ£€æµ‹çš„ URL
}
```

### Gateway é…ç½®
```typescript
{
  gateway: {
    port?: number,              // ç«¯å£ï¼ˆé»˜è®¤ 18789ï¼‰
    tls?: { enabled?: boolean }, // TLS å¯ç”¨çŠ¶æ€
    auth?: {
      mode?: "token" | "password",  // è®¤è¯æ¨¡å¼
      token?: string,
      password?: string,
    },
    bind?: "loopback" | "lan" | "tailnet" | "custom",
    customBindHost?: string,
    tailscale?: {
      mode?: "off" | "serve" | "funnel",
    },
    remote?: {
      url?: string,  // è¿œç¨‹ URL
    },
  },
}
```

## æ³¨æ„äº‹é¡¹

1. **å®‰å…¨æ€§**ï¼šé…å¯¹ä»£ç åŒ…å«è®¤è¯å‡­æ®ï¼Œåº”å¦¥å–„ä¿ç®¡
2. **è¿‡æœŸæ—¶é—´**ï¼šé…å¯¹è¯·æ±‚ä¸ä¼šè‡ªåŠ¨è¿‡æœŸï¼Œéœ€æ‰‹åŠ¨å®¡æ‰¹æˆ–æ‹’ç»
3. **Telegram åˆ†ç¦»**ï¼šTelegram æ¸ é“ä¼šåˆ†ä¸¤æ¡æ¶ˆæ¯å‘é€è¯´æ˜å’Œä»£ç 
4. **æƒé™è¦æ±‚**ï¼šiOS åº”ç”¨ä»éœ€ç”¨æˆ·æˆæƒç›¸æœºã€ç…§ç‰‡ç­‰æƒé™

## ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶
- `index.ts` - æ’ä»¶å…¥å£å’Œå‘½ä»¤æ³¨å†Œ
- `openclaw.plugin.json` - æ’ä»¶æ¸…å•

## å˜æ›´è®°å½•

### 2026-02-13 - åˆå§‹åˆ›å»º
- âœ… åˆ›å»º Device Pair æ‰©å±•æ–‡æ¡£
- ğŸ“‹ è®°å½•é…å¯¹æµç¨‹å’Œå‘½ä»¤
- ğŸ”— å»ºç«‹ä¸ç§»åŠ¨èŠ‚ç‚¹çš„å…³è”


<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>