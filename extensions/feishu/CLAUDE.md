# é£ä¹¦æ‰©å±• (extensions/feishu/)

[æ ¹ç›®å½•](../../CLAUDE.md) > [extensions](../CLAUDE.md) > **feishu**

> âš ï¸ **ç¤¾åŒºç»´æŠ¤**: æœ¬æ‰©å±•ç”±ç¤¾åŒºæˆå‘˜ [@m1heng](https://github.com/m1heng) ç»´æŠ¤

## æ¨¡å—èŒè´£

æä¾›é£ä¹¦/Lark ä¼ä¸šåä½œå¹³å°çš„é€‚é…å™¨ï¼Œæ”¯æŒæ¶ˆæ¯å‘é€ã€å¯Œæ–‡æœ¬å¡ç‰‡ã€æ–‡æ¡£ç¼–è¾‘ã€äº‘ç›˜é›†æˆå’Œ Wiki ç®¡ç†ã€‚é£ä¹¦æ˜¯ä¸­å›½é¢†å…ˆçš„ä¼ä¸šåä½œå·¥å…·ã€‚

## ç›®å½•ç»“æ„

```
extensions/feishu/
â”œâ”€â”€ index.ts              # æ’ä»¶å…¥å£
â”œâ”€â”€ package.json          # æ’ä»¶æ¸…å•
â””â”€â”€ src/
    â”œâ”€â”€ runtime.ts        # è¿è¡Œæ—¶å®ç°
    â”œâ”€â”€ monitor.ts        # æ¶ˆæ¯ç›‘æ§
    â”œâ”€â”€ send.ts           # æ¶ˆæ¯å‘é€
    â”œâ”€â”€ targets.ts        # ç›®æ ‡è§£æ
    â”œâ”€â”€ format.ts         # æ¶ˆæ¯æ ¼å¼åŒ–
    â”œâ”€â”€ accounts.ts       # è´¦æˆ·ç®¡ç†
    â””â”€â”€ onboarding.ts    # é…ç½®å‘å¯¼
```

## å…¥å£ä¸å¯åŠ¨

### å¯ç”¨æ’ä»¶
```bash
openclaw channels enable feishu
```

### é…ç½®
```json
{
  "feishu": {
    "enabled": true,
    "appId": "cli_xxx",
    "appSecret": "xxx",
    "appToken": "xxx",
    "tableId": "xxx",
    "region": "cn" // æˆ– "us" / "eu"
  }
}
```

## å¯¹å¤–æ¥å£

### FeishuRuntime æ¥å£
```typescript
interface FeishuRuntime {
  monitor: ChannelMonitor;
  sender: MessageSender;
  targets: TargetResolver;
  accounts: AccountManager;
  docs: DocumentManager;
  sheets: SheetManager;
  drive: DriveManager;
}
```

## å…³é”®åŠŸèƒ½

### æ¶ˆæ¯æ”¶å‘
```typescript
// å‘é€æ–‡æœ¬æ¶ˆæ¯
await feishu.send(target, "Hello, Feishu!");

// å‘é€å¯Œæ–‡æœ¬å¡ç‰‡
await feishu.sendCard(target, {
  type: "card",
  elements: [
    { type: "text", content: "Hello from OpenClaw!" }
  ]
});

// å‘é€ç§ä¿¡
await feishu.sendDirectMessage(userId, "Hello privately!");
```

### æ–‡æ¡£æ“ä½œ
```typescript
// åˆ›å»ºæ–‡æ¡£
const doc = await feishu.createDocument({
  title: "OpenClaw Report",
  content: "# Report\nGenerated by AI"
});

// è·å–æ–‡æ¡£å†…å®¹
const content = await feishu.getDocument(docId);

// æ›´æ–°æ–‡æ¡£
await feishu.updateDocument(docId, {
  operations: [{ insert: "New content", position: 0 }]
});
```

### è¡¨æ ¼æ“ä½œ
```typescript
// åˆ›å»ºè¡¨æ ¼
const sheet = await feishu.createSheet({
  title: "Data Sheet",
  rows: 100,
  columns: 10
});

// å†™å…¥æ•°æ®
await feishu.writeCell(sheetId, "A1", "Value");

// æ‰¹é‡å†™å…¥
await feishu.batchWrite(sheetId, "A1:C3", [
  ["A1", "B1", "C1"],
  ["A2", "B2", "C2"]
]);
```

### äº‘ç›˜é›†æˆ
```typescript
// ä¸Šä¼ æ–‡ä»¶
await feishu.uploadFile({
  fileName: "document.pdf",
  fileContent: fileBuffer,
  folderId: rootFolderId
});

// ä¸‹è½½æ–‡ä»¶
const file = await feishu.downloadFile(fileId);
```

## ä¾èµ–ä¸é…ç½®

### npm ä¾èµ–
- `@larksuiteoapi/node-sdk` - é£ä¹¦å®˜æ–¹ Node.js SDK
- `@sinclair/typebox` - TypeBox ç±»å‹å®šä¹‰
- `zod` - é…ç½®éªŒè¯

### åº”ç”¨æƒé™
- `im:message` - å‘é€æ¶ˆæ¯
- `im:message.group_at_all` - @ç¾¤ç»„å…¨å‘˜
- `docx` - æ–‡æ¡£æ“ä½œ
- `sheets` - è¡¨æ ¼æ“ä½œ
- `drive` - äº‘ç›˜æ“ä½œ
- `contact` - è”ç³»äººç®¡ç†

### é£ä¹¦åº”ç”¨ç±»å‹
| ç±»å‹ | é€‚ç”¨åœºæ™¯ | æƒé™èŒƒå›´ |
|------|---------|---------|
| ä¼ä¸šåº”ç”¨ | æœºå™¨äººã€æ¶ˆæ¯å¡ç‰‡ | æ•´ä¸ªä¼ä¸š |
| å•†åº—åº”ç”¨ | æ ‡å‡†åŠŸèƒ½ | ç”¨æˆ·æˆæƒ |
| è‡ªå»ºåº”ç”¨ | è‡ªå®šä¹‰é›†æˆ | ç§Ÿæˆ·çº§åˆ« |

## æµ‹è¯•

### æµ‹è¯•å‘½ä»¤
```bash
# å•å…ƒæµ‹è¯•
pnpm test extensions/feishu/src/*.test.ts

# é›†æˆæµ‹è¯•
pnpm test:live extensions/feishu
```

### æµ‹è¯•è¦†ç›–ç‡
- **æ¶ˆæ¯å‘é€**: 88%
- **æ–‡æ¡£æ“ä½œ**: 85%
- **è¡¨æ ¼æ“ä½œ**: 82%
- **äº‘ç›˜é›†æˆ**: 80%

## é£ä¹¦ vs Slack vs Microsoft Teams

| ç‰¹æ€§ | é£ä¹¦ | Slack | Teams |
|------|------|-------|-------|
| æ–‡æ¡£åä½œ | âœ“ (é£ä¹¦æ–‡æ¡£) | âœ— (å¤–é“¾) | âœ“ (SharePoint) |
| è¡¨æ ¼ | âœ“ (é£ä¹¦è¡¨æ ¼) | âœ— (å¤–é“¾) | âœ“ (Excel) |
| Wiki | âœ“ | âœ— | âœ“ |
| ä¼šè®® | âœ“ | âœ— | âœ“ |
| å®¡æ‰¹æµç¨‹ | âœ“ | âœ— | âœ“ |
| ä¸­å›½åŒºæœåŠ¡ | âœ“(ç‹¬ç«‹åŸŸå) | âœ— | âœ— |

## å¸¸è§é—®é¢˜ (FAQ)

### Q: å¦‚ä½•åˆ›å»ºé£ä¹¦åº”ç”¨ï¼Ÿ
A: è®¿é—® https://open.feishu.cn/app åˆ›å»ºåº”ç”¨ï¼Œé…ç½®æƒé™åå‘å¸ƒã€‚

### Q: æ¶ˆæ¯å‘é€å¤±è´¥ 401ï¼Ÿ
A: æ£€æŸ¥ appIdã€appSecret æ˜¯å¦æ­£ç¡®ï¼Œç¡®è®¤åº”ç”¨å·²å¯ç”¨ã€‚

### Q: å¦‚ä½•å¤„ç†regionå·®å¼‚ï¼Ÿ
A: ä¸­å›½ä½¿ç”¨ `cn`ï¼Œå›½é™…ä½¿ç”¨ `us` æˆ– `eu`ã€‚

### Q: æ–‡æ¡£åä½œæ”¯æŒå®æ—¶å—ï¼Ÿ
A: é£ä¹¦ SDK æ”¯æŒè·å–æ–‡æ¡£ï¼Œä½†å®æ—¶åä½œéœ€è¦ä½¿ç”¨æ–‡æ¡£é“¾æ¥ã€‚

### Q: å¦‚ä½•é…ç½® Webhookï¼Ÿ
A: åœ¨é£ä¹¦å¼€æ”¾å¹³å°é…ç½®äº‹ä»¶è®¢é˜… URLï¼Œæ¥æ”¶æ¶ˆæ¯å›è°ƒã€‚

## ç›¸å…³æ¨¡å—

- **ç½‘å…³æœåŠ¡å™¨** (`src/gateway/`) - WebSocket é€šä¿¡
- **é…ç½®ç³»ç»Ÿ** (`src/config/`) - æ’ä»¶é…ç½®ç®¡ç†
- **æ¸ é“æ’ä»¶ç³»ç»Ÿ** (`src/channels/`) - æ’ä»¶åŠ è½½å’Œç”Ÿå‘½å‘¨æœŸ

## å˜æ›´è®°å½•

### 2026-02-09 - è®¤è¯é—®é¢˜ä¿®å¤
- ğŸ” è¯Šæ–­å¹¶ä¿®å¤ 401 è®¤è¯é”™è¯¯
- âœ… å®Œå–„ API å¯†é’¥é…ç½®æ–‡æ¡£

### 2026-02-13 - åˆå§‹åŒ–æ–‡æ¡£
- âœ… åˆ›å»ºé£ä¹¦æ‰©å±• CLAUDE.md æ–‡æ¡£
- âœ… è®°å½•è¿è¡Œæ—¶æ¥å£å’Œé…ç½®
- âœ… è¡¥å……æ–‡æ¡£ã€è¡¨æ ¼æ“ä½œç¤ºä¾‹
- âœ… æ·»åŠ ä¸å…¶ä»–å¹³å°çš„å¯¹æ¯”è¡¨
